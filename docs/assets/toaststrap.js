var Toaststrap;(()=>{"use strict";var t=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e={};(()=>{t(e);var i,o,n="toaststrap-";function s(t){return n+t}!function(t){t.TOP_START="TOP_START",t.TOP_END="TOP_END",t.TOP_CENTER="TOP_CENTER",t.BOTTOM_START="BOTTOM_START",t.BOTTOM_END="BOTTOM_END",t.BOTTOM_CENTER="BOTTOM_CENTER"}(i||(i={})),function(t){t.DEFAULT="DEFAULT",t.PRIMARY="PRIMARY",t.INFO="INFO",t.SUCCESS="SUCCESS",t.WARNING="WARNING",t.DANGER="DANGER",t.DARK="DARK",t.SWEET="SWEET"}(o||(o={}));const r={positions:{TOP_START:s("top")+" "+s("start"),TOP_END:s("top")+" "+s("end"),TOP_CENTER:s("top")+" "+s("center"),BOTTOM_CENTER:s("bottom")+" "+s("center"),BOTTOM_START:s("bottom")+" "+s("start"),BOTTOM_END:s("bottom")+" "+s("end")},types:{DEFAULT:["bg-default"],PRIMARY:["bg-primary","text-light"],INFO:["bg-info","text-light"],SUCCESS:["bg-success","text-light"],WARNING:["bg-warning","text-dark"],DANGER:["bg-danger","text-light"],DARK:["bg-dark","text-light"],SECONDARY:["bg-secondary","text-light"],SWEET:["bg-sweet","text-light"]}};var a=function(t,e){return t.classList.contains(e)};const u=function(){function t(t,e){return this.selector="".concat(n,"-notification"),this.element=new Audio(t),this.parent=e,this.make(),this}return t.prototype.make=function(){this.element.id=this.selector,this.parent.querySelector("#"+this.selector)||this.parent.appendChild(this.element)},Object.defineProperty(t.prototype,"instance",{get:function(){return this.element},enumerable:!1,configurable:!0}),t}(),p=function(){function t(t,e){return this.times={SECOND:1e3,MINUTE:6e4,HOUR:36e5,DAY:864e5,WEEK:6048e5,YEAR:31536e6,MONTH:2628e6},this.formats=[[.7*this.times.MINUTE,"just now"],[1.5*this.times.MINUTE,"a minute ago"],[60*this.times.MINUTE,"minutes ago",this.times.MINUTE],[1.5*this.times.HOUR,"an hour ago"],[this.times.DAY,"hours ago",this.times.HOUR],[2*this.times.DAY,"yesterday"],[7*this.times.DAY,"days ago",this.times.DAY],[1.5*this.times.WEEK,"a week ago"],[this.times.MONTH,"weeks ago",this.times.WEEK],[1.5*this.times.MONTH,"a month ago"],[this.times.YEAR,"months ago",this.times.MONTH],[1.5*this.times.YEAR,"a year ago"],[Number.MAX_VALUE,"years ago",this.times.YEAR]],this.input=t,this.reference=e,e?e instanceof Date&&(this.reference=e.getTime()):this.reference=(new Date).getTime(),t instanceof Date&&this.input.getTime(),"string"==typeof t&&(this.input=+new Date(t).getTime()),this}return t.prototype.print=function(){var t,e,i,o=this.reference-this.input;for(e=-1,i=this.formats.length;++e<i;)if(o<(t=this.formats[e])[0])return null==t[2]?t[1]:Math.round(o/t[2])+" "+t[1];return"Unknown"},t}(),c=function(){function t(){}return t.strFormat=function(t,e){if(t&&Object.keys(e).length>0){var i=new RegExp(/([{}])\1|[{](.*?)(?:!(.+?))?[}]/g);return t.replace(i,(function(t){var i=t.replace(/{/,"").replace(/}/,"");return e[i]?e[i]:t}))}return t},t.makeId=function(){return String(Math.floor(1e10+9e9*Math.random()))},t}();var l=function(){return l=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},l.apply(this,arguments)};const d=function(){function t(t){var e=this;if(this.closeEvent=function(){e.destroy(e.item)},this.options=l({avatar:"",dismissible:!0,duration:3e3,offset:10,parent:"body",pausable:!0,position:i.TOP_END,progress:!0,snackbar:!1,soundSource:"",soundable:!1,subtitle:{relative:!0,datetime:Date.now()},text:"",title:"",type:o.DEFAULT},t),"string"!=typeof this.options.subtitle&&"object"==typeof this.options.subtitle&&"datetime"in this.options.subtitle){var n=this.options.subtitle;"relative"in this.options.subtitle&&this.options.subtitle.relative?this.options.subtitle=new p(n.datetime).print():this.options.subtitle=String(n.datetime)}this.group=this.options.position||i.TOP_END,Object.keys(i).includes(this.options.position)?this.options.position=r.positions[this.options.position]:this.options.position=r.positions.TOP_END,this.item=document.createElement("div"),this.spaceBetween=5,this.options.soundable&&this.options.soundSource&&this.options.soundSource.length>0&&(this.sound=new u(this.options.soundSource,this.parentElement)),this.id=c.makeId(),this.createdAt=Date.now().toString(),this.timeout=setTimeout((function(){}),0),this.progressInterval=setInterval((function(){}),0),this.pauseProgressInterval=!1,this.progressStartTime=0}return t.prototype.show=function(){var t=this.parentElement,e=this.build;return t.insertBefore(e,t.firstChild),this.sound&&this.sound.instance.play().catch((function(){console.warn("Sound source given not found or not supported.")})),this.organize(),this},Object.defineProperty(t.prototype,"build",{get:function(){var t,e,i,o=this,n=(e=this.options,(i=document.createElement("div")).className="".concat(this.options.parent?"position-absolute":"position-fixed"," ").concat(e.position,"-").concat(e.offset," ").concat(s("container")),i.style.zIndex="2500",i),a=document.createElement("div");if(a.classList.add("toast"),n.setAttribute("data-id",this.id),n.setAttribute("data-created-at",this.createdAt),n.setAttribute("data-type",this.options.type?this.options.type.toLowerCase():""),n.setAttribute("data-group",this.group),n.setAttribute("data-snackbar",String(this.options.snackbar)),Boolean(this.options.snackbar)?(t=a.classList).add.apply(t,r.types[this.options.type]):a.appendChild(function(t){var e,i=t.options,o=document.createElement("div");o.classList.add("toast-header"),i.avatar&&o.appendChild(function(t){var e=document.createElement("img");return e.classList.add("rounded","me-2"),e.src=t.avatar||"",e.width=20,e.height=20,e}(i)),i.type&&(e=o.classList).add.apply(e,r.types[i.type]);var n,s,a=document.createElement("strong");if(a.classList.add("me-auto"),a.innerText=i.title,o.appendChild(a),i.subtitle){var u=document.createElement("small");"string"==typeof i.subtitle&&(u.innerText=i.subtitle),o.appendChild(u)}return i.dismissible&&o.appendChild((n=t.closeEvent,(s=document.createElement("button")).classList.add("btn-close"),s.setAttribute("type","button"),s.setAttribute("area-label","Close"),s.addEventListener("click",(function(t){t.stopPropagation(),n()})),s)),o}(this)),a.appendChild(function(t){var e=t.options,i=document.createElement("div");return i.classList.add("toast-body"),i.innerHTML=e.text,i}(this)),this.options.progress&&a.appendChild(function(t){var e=t.options.duration,i=document.createElement("div");i.classList.add("toast-footer");var o=document.createElement("div");return o.classList.add("toast-footer-inner"),i.appendChild(o),e>0&&(e<100&&(e*=1e3),o.style.animationDuration="".concat(e,"ms")),i}(this)),n.appendChild(a),new ResizeObserver((function(){o.organize()})).observe(n),this.item=n,n.classList.add("show"),this.options.duration>0&&(this.timeout=setTimeout((function(){o.destroy(n)}),this.options.duration),this.options.pausable)){var u=function(){clearTimeout(o.timeout),o.pauseProgressInterval=!0},p=function(){o.pauseProgressInterval=!1,o.progressStartTime=(new Date).getTime(),o.timeout=setTimeout((function(){o.destroy(o.item)}),o.options.duration)};"mouseover touchstart touchend".split(" ").forEach((function(t){o.item.addEventListener(t,u)})),"mouseleave touchend".split(" ").forEach((function(t){o.item.addEventListener(t,p)}))}return n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentElement",{get:function(){if(this.options.parent){var t=document.querySelector(this.options.parent);if(!t)throw"User root element not exists.";return Array.isArray(t)?t[0]:t}return document.body},enumerable:!1,configurable:!0}),t.prototype.destroy=function(t){t.classList.remove("show"),"function"==typeof this.options.onClose&&this.options.onClose(this),window.setTimeout((function(){var e;null===(e=t.parentNode)||void 0===e||e.removeChild(t)}),400)},t.prototype.organize=function(){var t=this,e=this.options.offset,i={top:Number(e),bottom:Number(e)},o={top:Number(e),bottom:Number(e)},r={top:Number(e),bottom:Number(e)},u=".".concat(s("container"),"[data-group='").concat(this.group,"']"),p=window.innerWidth>0?window.innerWidth:screen.width;p<=360&&(u=".".concat(s("container")));var c,l=document.querySelectorAll(u);l.length>0&&l.forEach((function(e){c=a(e,s("top"))?s("top"):a(e,s("middle"))?s("middle"):s("bottom");var u=e.offsetHeight;c=c.substr("".concat(n,"-").length-1,c.length-1),p<=360?(e.style[c]=r[c]+"px",r[c]+=u+t.spaceBetween):a(e,"start-".concat(t.options.offset))?(e.style[c]=i[c]+"px",i[c]+=u+t.spaceBetween):(e.style[c]=o[c]+"px",o[c]+=u+t.spaceBetween)}))},t}();var h="TypeError: Option {option} should be in type {type}.",m=function(t,e,i){return void 0===e&&(e=self),void 0===i&&(i="."),(Array.isArray(t)?t:t.split(i)).reduce((function(t,e){return t&&t[e]}),e)},f=[[h,"dismissible","boolean"],[h,"duration","number"],[h,"offset","number"],[h,"onClose","function"],[h,"onShow","function"],[h,"parent","string"],[h,"pausable","boolean"],[h,"position","string"],[h,"progress","boolean"],[h,"snackbar","boolean"],[h,"soundSource","string"],[h,"soundable","boolean"],[h,"subtitle",["string","object"]],[h,"text","string"],[h,"title","string"],[h,"type","string"],[h,"subtitle.relative","boolean"],[h,"subtitle.datetime",["string","Date","number"]]];var b=function(){return b=Object.assign||function(t){for(var e,i=1,o=arguments.length;i<o;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},b.apply(this,arguments)};window.toaststrap=function(t){return Object.keys(t).length&&function(t){f.length>0&&f.forEach((function(e){var i=e[0],o=e[1],n=e[2];if(Array.isArray(n)){var s=!1;if(n.forEach((function(e){void 0===m(o,t)||typeof m(o,t)!==e||(s=!0)})),!s)throw c.strFormat(i,{option:o,type:n.toString()})}else if(m(o,t)&&typeof m(o,t)!==n)throw c.strFormat(i,{option:o,type:n})}))}(t),new d(b({},t))},window.toaststrap_position=i,window.toaststrap_type=o})(),Toaststrap=e})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ck0sRUFDN0JxSyxPQUFPaUMsZ0JBQWtCck0sRyIsInNvdXJjZXMiOlsid2VicGFjazovL1RvYXN0c3RyYXAvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vVG9hc3RzdHJhcC93ZWJwYWNrL3J1bnRpbWUvbWFrZSBuYW1lc3BhY2Ugb2JqZWN0Iiwid2VicGFjazovL1RvYXN0c3RyYXAvLi9zcmMvcHJlZmVyZW5jZXMudHMiLCJ3ZWJwYWNrOi8vVG9hc3RzdHJhcC8uL3NyYy9oZWxwZXJzLnRzIiwid2VicGFjazovL1RvYXN0c3RyYXAvLi9zcmMvY29tcG9uZW50cy9zb3VuZC50cyIsIndlYnBhY2s6Ly9Ub2FzdHN0cmFwLy4vc3JjL1JlbGF0aXZlRGF0ZS50cyIsIndlYnBhY2s6Ly9Ub2FzdHN0cmFwLy4vc3JjL1V0aWwudHMiLCJ3ZWJwYWNrOi8vVG9hc3RzdHJhcC8uL3NyYy9Ub2FzdHN0cmFwLnRzIiwid2VicGFjazovL1RvYXN0c3RyYXAvLi9zcmMvY29tcG9uZW50cy9jb250YWluZXIudHMiLCJ3ZWJwYWNrOi8vVG9hc3RzdHJhcC8uL3NyYy9jb21wb25lbnRzL2hlYWRlci50cyIsIndlYnBhY2s6Ly9Ub2FzdHN0cmFwLy4vc3JjL2NvbXBvbmVudHMvYm9keS50cyIsIndlYnBhY2s6Ly9Ub2FzdHN0cmFwLy4vc3JjL2NvbXBvbmVudHMvcHJvZ3Jlc3MudHMiLCJ3ZWJwYWNrOi8vVG9hc3RzdHJhcC8uL3NyYy90eXBlY2hlY2sudHMiLCJ3ZWJwYWNrOi8vVG9hc3RzdHJhcC8uL3NyYy9icm93c2VyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSAoZXhwb3J0cykgPT4ge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiLCIvKipcbiAqIFByZWZpeCB3aWxsIGJlIGFwcGxpZWQgdG8gYWxsIGNzcyBjbGFzc2VzLlxuICovXG5leHBvcnQgY29uc3QgY3ByZWZpeCA9IFwidG9hc3RzdHJhcC1cIlxuXG4vKipcbiAqIEdldCB0aGUgY2xhc3NuYW1lIHdpdGggdGhlIHByZWZpeC5cbiAqIEBwYXJhbSB7c3RyaW5nfSBjXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnY2xhc3MoYzogc3RyaW5nKSB7XG4gIHJldHVybiBjcHJlZml4ICsgY1xufVxuXG5leHBvcnQgZW51bSBQT1NJVElPTlMge1xuICBUT1BfU1RBUlQgPSBcIlRPUF9TVEFSVFwiLFxuICBUT1BfRU5EID0gXCJUT1BfRU5EXCIsXG4gIFRPUF9DRU5URVIgPSBcIlRPUF9DRU5URVJcIixcbiAgQk9UVE9NX1NUQVJUID0gXCJCT1RUT01fU1RBUlRcIixcbiAgQk9UVE9NX0VORCA9IFwiQk9UVE9NX0VORFwiLFxuICBCT1RUT01fQ0VOVEVSID0gXCJCT1RUT01fQ0VOVEVSXCIsXG59XG5cbmV4cG9ydCBlbnVtIFRZUEVTIHtcbiAgREVGQVVMVCA9IFwiREVGQVVMVFwiLFxuICBQUklNQVJZID0gXCJQUklNQVJZXCIsXG4gIElORk8gPSBcIklORk9cIixcbiAgU1VDQ0VTUyA9IFwiU1VDQ0VTU1wiLFxuICBXQVJOSU5HID0gXCJXQVJOSU5HXCIsXG4gIERBTkdFUiA9IFwiREFOR0VSXCIsXG4gIERBUksgPSBcIkRBUktcIixcbiAgU1dFRVQgPSBcIlNXRUVUXCJcbn1cblxuLyoqXG4gKlxuICovXG5leHBvcnQgZGVmYXVsdCB7XG4gIHBvc2l0aW9uczoge1xuICAgIC8vIFRPUFxuICAgIFRPUF9TVEFSVDogZ2NsYXNzKFwidG9wXCIpICsgXCIgXCIgKyBnY2xhc3MoXCJzdGFydFwiKSxcbiAgICBUT1BfRU5EOiBnY2xhc3MoXCJ0b3BcIikgKyBcIiBcIiArIGdjbGFzcyhcImVuZFwiKSxcbiAgICBUT1BfQ0VOVEVSOiBnY2xhc3MoXCJ0b3BcIikgKyBcIiBcIiArIGdjbGFzcyhcImNlbnRlclwiKSxcblxuICAgIC8vIEJvdHRvbVxuICAgIEJPVFRPTV9DRU5URVI6IGdjbGFzcyhcImJvdHRvbVwiKSArIFwiIFwiICsgZ2NsYXNzKFwiY2VudGVyXCIpLFxuICAgIEJPVFRPTV9TVEFSVDogZ2NsYXNzKFwiYm90dG9tXCIpICsgXCIgXCIgKyBnY2xhc3MoXCJzdGFydFwiKSxcbiAgICBCT1RUT01fRU5EOiBnY2xhc3MoXCJib3R0b21cIikgKyBcIiBcIiArIGdjbGFzcyhcImVuZFwiKSxcbiAgfSxcblxuICB0eXBlczoge1xuICAgIERFRkFVTFQ6IFtcImJnLWRlZmF1bHRcIl0sXG4gICAgUFJJTUFSWTogW1wiYmctcHJpbWFyeVwiLCBcInRleHQtbGlnaHRcIl0sXG4gICAgSU5GTzogW1wiYmctaW5mb1wiLCBcInRleHQtbGlnaHRcIl0sXG4gICAgU1VDQ0VTUzogW1wiYmctc3VjY2Vzc1wiLCBcInRleHQtbGlnaHRcIl0sXG4gICAgV0FSTklORzogW1wiYmctd2FybmluZ1wiLCBcInRleHQtZGFya1wiXSxcbiAgICBEQU5HRVI6IFtcImJnLWRhbmdlclwiLCBcInRleHQtbGlnaHRcIl0sXG4gICAgREFSSzogW1wiYmctZGFya1wiLCBcInRleHQtbGlnaHRcIl0sXG4gICAgU0VDT05EQVJZOiBbXCJiZy1zZWNvbmRhcnlcIiwgXCJ0ZXh0LWxpZ2h0XCJdLFxuXG4gICAgLy8gSSBtYWRlIHRoaXMgb25lIGZvciBmdW4sIHlvdSBjYW4gYWRkIHlvdXIgb3duIHN0eWxlcyB0b28uXG4gICAgU1dFRVQ6IFtcImJnLXN3ZWV0XCIsIFwidGV4dC1saWdodFwiXSxcbiAgfSxcbn1cblxuIiwiY29uc3QgaGFzQ2xhc3MgPSAoZWxlbWVudDogRWxlbWVudCwgY2xhc3NOYW1lOiBzdHJpbmcpID0+IHtcbiAgcmV0dXJuIGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKGNsYXNzTmFtZSlcbn1cblxuXG5leHBvcnQgeyBoYXNDbGFzcyB9XG4iLCJpbXBvcnQgeyBjcHJlZml4IH0gZnJvbSBcIi4uL3ByZWZlcmVuY2VzXCJcblxuY2xhc3MgU291bmQge1xuICBwcml2YXRlIGVsZW1lbnQ6IEhUTUxBdWRpb0VsZW1lbnRcbiAgcHJpdmF0ZSBzZWxlY3Rvcjogc3RyaW5nXG4gIHByaXZhdGUgcGFyZW50OiBFbGVtZW50XG5cbiAgY29uc3RydWN0b3IoYXVkaW9GaWxlOiBzdHJpbmcsIHBhcmVudEVsZW1lbnQ6IEVsZW1lbnQpIHtcbiAgICB0aGlzLnNlbGVjdG9yID0gYCR7Y3ByZWZpeH0tbm90aWZpY2F0aW9uYFxuICAgIHRoaXMuZWxlbWVudCA9IG5ldyBBdWRpbyhhdWRpb0ZpbGUpXG4gICAgdGhpcy5wYXJlbnQgPSBwYXJlbnRFbGVtZW50XG5cblxuICAgIHRoaXMubWFrZSgpXG5cbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgcHJpdmF0ZSBtYWtlKCkge1xuICAgIHRoaXMuZWxlbWVudC5pZCA9IHRoaXMuc2VsZWN0b3JcblxuICAgIGlmICghdGhpcy5wYXJlbnQucXVlcnlTZWxlY3RvcihcIiNcIiArIHRoaXMuc2VsZWN0b3IpKSB7XG4gICAgICB0aGlzLnBhcmVudC5hcHBlbmRDaGlsZCh0aGlzLmVsZW1lbnQpXG4gICAgfVxuXG4gIH1cblxuICBwdWJsaWMgZ2V0IGluc3RhbmNlKCkge1xuICAgIHJldHVybiB0aGlzLmVsZW1lbnRcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBTb3VuZCIsImNsYXNzIFJlbGF0aXZlRGF0ZSB7XG5cbiAgcHJpdmF0ZSByZWFkb25seSBmb3JtYXRzXG4gIHByaXZhdGUgcmVhZG9ubHkgdGltZXNcbiAgcHJpdmF0ZSByZWFkb25seSBpbnB1dFxuICBwcml2YXRlIHJlYWRvbmx5IHJlZmVyZW5jZVxuXG4gIGNvbnN0cnVjdG9yKGlucHV0LCByZWZlcmVuY2U/OiBhbnkpIHtcbiAgICB0aGlzLnRpbWVzID0ge1xuICAgICAgU0VDT05EOiAxMDAwLFxuICAgICAgTUlOVVRFOiA2MCAqIDEwMDAsXG4gICAgICBIT1VSOiA2MCAqIDYwICogMTAwMCxcbiAgICAgIERBWTogMjQgKiA2MCAqIDYwICogMTAwMCxcbiAgICAgIFdFRUs6IDcgKiAyNCAqIDYwICogNjAgKiAxMDAwLFxuICAgICAgWUVBUjogMzY1ICogMjQgKiA2MCAqIDYwICogMTAwMCxcbiAgICAgIE1PTlRIOiAoMzY1ICogMjQgKiA2MCAqIDYwICogMTAwMCkgLyAxMixcbiAgICB9XG5cblxuICAgIHRoaXMuZm9ybWF0cyA9IFtcbiAgICAgIFswLjcgKiB0aGlzLnRpbWVzLk1JTlVURSwgXCJqdXN0IG5vd1wiXSxcbiAgICAgIFsxLjUgKiB0aGlzLnRpbWVzLk1JTlVURSwgXCJhIG1pbnV0ZSBhZ29cIl0sXG4gICAgICBbNjAgKiB0aGlzLnRpbWVzLk1JTlVURSwgXCJtaW51dGVzIGFnb1wiLCB0aGlzLnRpbWVzLk1JTlVURV0sXG4gICAgICBbMS41ICogdGhpcy50aW1lcy5IT1VSLCBcImFuIGhvdXIgYWdvXCJdLFxuICAgICAgW3RoaXMudGltZXMuREFZLCBcImhvdXJzIGFnb1wiLCB0aGlzLnRpbWVzLkhPVVJdLFxuICAgICAgWzIgKiB0aGlzLnRpbWVzLkRBWSwgXCJ5ZXN0ZXJkYXlcIl0sXG4gICAgICBbNyAqIHRoaXMudGltZXMuREFZLCBcImRheXMgYWdvXCIsIHRoaXMudGltZXMuREFZXSxcbiAgICAgIFsxLjUgKiB0aGlzLnRpbWVzLldFRUssIFwiYSB3ZWVrIGFnb1wiXSxcbiAgICAgIFt0aGlzLnRpbWVzLk1PTlRILCBcIndlZWtzIGFnb1wiLCB0aGlzLnRpbWVzLldFRUtdLFxuICAgICAgWzEuNSAqIHRoaXMudGltZXMuTU9OVEgsIFwiYSBtb250aCBhZ29cIl0sXG4gICAgICBbdGhpcy50aW1lcy5ZRUFSLCBcIm1vbnRocyBhZ29cIiwgdGhpcy50aW1lcy5NT05USF0sXG4gICAgICBbMS41ICogdGhpcy50aW1lcy5ZRUFSLCBcImEgeWVhciBhZ29cIl0sXG4gICAgICBbTnVtYmVyLk1BWF9WQUxVRSwgXCJ5ZWFycyBhZ29cIiwgdGhpcy50aW1lcy5ZRUFSXSxcbiAgICBdXG5cblxuICAgIHRoaXMuaW5wdXQgPSBpbnB1dFxuICAgIHRoaXMucmVmZXJlbmNlID0gcmVmZXJlbmNlXG5cbiAgICBpZiAoIXJlZmVyZW5jZSkge1xuICAgICAgdGhpcy5yZWZlcmVuY2UgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpXG4gICAgfSBlbHNlIGlmIChyZWZlcmVuY2UgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICB0aGlzLnJlZmVyZW5jZSA9IHJlZmVyZW5jZS5nZXRUaW1lKClcbiAgICB9XG5cbiAgICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICB0aGlzLmlucHV0LmdldFRpbWUoKVxuICAgIH1cblxuICAgIGlmICh0eXBlb2YgaW5wdXQgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgIHRoaXMuaW5wdXQgPSArbmV3IERhdGUoaW5wdXQpLmdldFRpbWUoKVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICBwdWJsaWMgcHJpbnQoKTogc3RyaW5nIHtcbiAgICBjb25zdCBkZWx0YSA9IHRoaXMucmVmZXJlbmNlIC0gdGhpcy5pbnB1dFxuICAgIGxldCBmb3JtYXQ6IGFueVtdXG4gICAgbGV0IGluZGV4OiBudW1iZXJcbiAgICBsZXQgbGVuZ3RoOiBudW1iZXJcblxuICAgIGZvciAoaW5kZXggPSAtMSwgbGVuZ3RoID0gdGhpcy5mb3JtYXRzLmxlbmd0aDsgKytpbmRleCA8IGxlbmd0aDspIHtcbiAgICAgIGZvcm1hdCA9IHRoaXMuZm9ybWF0c1tpbmRleF1cblxuICAgICAgaWYgKGRlbHRhIDwgZm9ybWF0WzBdKSB7XG4gICAgICAgIHJldHVybiBmb3JtYXRbMl0gPT0gdW5kZWZpbmVkID8gZm9ybWF0WzFdIDogTWF0aC5yb3VuZChkZWx0YSAvIGZvcm1hdFsyXSkgKyBcIiBcIiArIGZvcm1hdFsxXVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBcIlVua25vd25cIlxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFJlbGF0aXZlRGF0ZSIsIi8qKlxuICogUHJvdmlkZXMgc29tZSB1c2VmdWwgdXRpbGl0eS5cbiAqIEBjbGFzcyBVdGlsXG4gKi9cbmNsYXNzIFV0aWwge1xuXG4gIC8qKlxuICAgKiBGb3JtYXQgYSBzdHJpbmcgdGVtcGxhdGUuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzdHIgU3RyaW5nIHRvIGJlIGZvcm1hdC5cbiAgICogQHBhcmFtIHtvYmplY3R9IHZhbHVlcyBUaGUgdmFsdWVzIG9iamVjdC5cbiAgICogQHJldHVybiBzdHJpbmdcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgc3RyRm9ybWF0KHN0cjogc3RyaW5nLCB2YWx1ZXM6IG9iamVjdCk6IHN0cmluZyB7XG4gICAgaWYgKHN0ciAmJiBPYmplY3Qua2V5cyh2YWx1ZXMpLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cCgvKFt7fV0pXFwxfFt7XSguKj8pKD86ISguKz8pKT9bfV0vZylcblxuXG4gICAgICByZXR1cm4gc3RyLnJlcGxhY2UocmVnZXgsIChpbmRleCkgPT4ge1xuICAgICAgICBsZXQga2V5ID0gaW5kZXgucmVwbGFjZSgvey8sIFwiXCIpLnJlcGxhY2UoL30vLCBcIlwiKVxuICAgICAgICBpZiAoIXZhbHVlc1trZXldKSB7XG4gICAgICAgICAgcmV0dXJuIGluZGV4XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdmFsdWVzW2tleV1cbiAgICAgIH0pXG4gICAgfVxuXG4gICAgcmV0dXJuIHN0clxuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGFuIHVuaXF1ZSBpZGVudGlmaWVyLlxuICAgKiBAcmV0dXJuIHN0cmluZ1xuICAgKi9cbiAgcHVibGljIHN0YXRpYyBtYWtlSWQoKSB7XG4gICAgcmV0dXJuIFN0cmluZyhNYXRoLmZsb29yKDEwMDAwMDAwMDAwICsgTWF0aC5yYW5kb20oKSAqIDkwMDAwMDAwMDApKVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFV0aWwiLCJpbXBvcnQgcHJlZmVyZW5jZXMsIHsgY3ByZWZpeCwgZ2NsYXNzIH0gZnJvbSBcIi4vcHJlZmVyZW5jZXNcIlxuaW1wb3J0IHsgaGFzQ2xhc3MgfSBmcm9tIFwiLi9oZWxwZXJzXCJcbmltcG9ydCB0eXBlIHsgT3B0aW9uc1R5cGUsIFN1YlRpdGxlVHlwZSB9IGZyb20gXCIuL3R5cGVzXCJcbmltcG9ydCB7IFBPU0lUSU9OUywgVFlQRVMgfSBmcm9tIFwiLi9wcmVmZXJlbmNlc1wiXG5pbXBvcnQgeyBIZWFkZXJDb21wb25lbnQgfSBmcm9tIFwiLi9jb21wb25lbnRzL2hlYWRlclwiXG5pbXBvcnQgeyBUb2FzdEJvZHkgfSBmcm9tIFwiLi9jb21wb25lbnRzL2JvZHlcIlxuaW1wb3J0IHsgVG9hc3RDb250YWluZXIgfSBmcm9tIFwiLi9jb21wb25lbnRzL2NvbnRhaW5lclwiXG5pbXBvcnQgU291bmQgZnJvbSBcIi4vY29tcG9uZW50cy9zb3VuZFwiXG5pbXBvcnQgeyBQcm9ncmVzc0NvbXBvbmVudCB9IGZyb20gXCIuL2NvbXBvbmVudHMvcHJvZ3Jlc3NcIlxuaW1wb3J0IFJlbGF0aXZlRGF0ZSBmcm9tIFwiLi9SZWxhdGl2ZURhdGVcIlxuaW1wb3J0IFV0aWwgZnJvbSBcIi4vVXRpbFwiXG5cbi8qKlxuICogVG9hc3RzdHJhcCBjbGFzcyBmb3IgYnVpbGRpbmcgYW5kIGdlbmVyYXRpbmcgdGhlIHRvYXN0LlxuICpcbiAqIEBjbGFzcyBUb2FzdHN0cmFwXG4gKlxuICogQHZlcnNpb24gMS4xLjBcbiAqL1xuY2xhc3MgVG9hc3RzdHJhcCB7XG5cbiAgLyoqXG4gICAqIFRoZSBUb2FzdCBpZGVudGlmaWVyLlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHJpdmF0ZSByZWFkb25seSBpZDogc3RyaW5nXG5cbiAgLyoqXG4gICAqIFRoZSB0b2FzdCBjcmVhdGVkIGF0IGRhdGUuXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwcml2YXRlIHJlYWRvbmx5IGNyZWF0ZWRBdDogc3RyaW5nXG5cbiAgLyoqXG4gICAqIFRoZSB0b2FzdCBvcHRpb25zLlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHVibGljIG9wdGlvbnM6IE9wdGlvbnNUeXBlXG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlZCB0b2FzdCBpdGVtLlxuICAgKiBVc2VkIHRvIGRlbGV0ZSwgcGF1c2Ugb3IgbW9kaWZ5IHRoZSBnZW5lcmF0ZWQgdG9hc3QuXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwcml2YXRlIGl0ZW06IEhUTUxFbGVtZW50XG5cbiAgLyoqXG4gICAqIFRoZSBzb3VuZCBvYmplY3QuXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwcml2YXRlIHJlYWRvbmx5IHNvdW5kOiBTb3VuZCB8IHVuZGVmaW5lZFxuXG4gIC8qKlxuICAgKiBUaGUgbWFyZ2lucyBiZXR3ZWVuIHRoZSBwYXJlbnROb2RlIGFuZCB0aGUgc2hvd24gdG9hc3QuXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBwcml2YXRlIHJlYWRvbmx5IHNwYWNlQmV0d2VlbjogbnVtYmVyXG5cbiAgLyoqXG4gICAqIFRoZSB0b2FzdCBncm91cC4gVXNlZCB0byBvcmdhbml6ZSB0aGUgdG9hc3RzLlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHJpdmF0ZSByZWFkb25seSBncm91cDogc3RyaW5nXG5cbiAgLyoqXG4gICAqIFRvYXN0IHRpbWUtb3V0IG9iamVjdC5cbiAgICogQHByaXZhdGVcbiAgICovXG4gIHByaXZhdGUgdGltZW91dDogTm9kZUpTLlRpbWVvdXRcblxuICAvKipcbiAgICogVG9hc3QgdGltZXIgb2JqZWN0LiBVc2VkIGluIHByb2dyZXNzLlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHVibGljIHByb2dyZXNzSW50ZXJ2YWw6IE5vZGVKUy5UaW1lclxuXG4gIC8qKlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHVibGljIHBhdXNlUHJvZ3Jlc3NJbnRlcnZhbDogYm9vbGVhblxuXG4gIC8qKlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHVibGljIHByb2dyZXNzU3RhcnRUaW1lOiBudW1iZXJcblxuXG4gIC8qKlxuICAgKiBDcmVhdGUgYSBUb2FzdHN0cmFwLlxuICAgKlxuICAgKiBAcGFyYW0ge09wdGlvbnNUeXBlfSBvcHRpb25zIC0gQXZhaWxhYmxlIG9wdGlvbnMgdG8gY3VzdG9taXplIHRoZSB0b2FzdC5cbiAgICovXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM/OiBPcHRpb25zVHlwZSkge1xuXG4gICAgdGhpcy5vcHRpb25zID0ge1xuICAgICAgYXZhdGFyOiBcIlwiLFxuICAgICAgZGlzbWlzc2libGU6IHRydWUsXG4gICAgICBkdXJhdGlvbjogMzAwMCxcbiAgICAgIG9mZnNldDogMTAsXG4gICAgICBwYXJlbnQ6IFwiYm9keVwiLFxuICAgICAgcGF1c2FibGU6IHRydWUsXG4gICAgICBwb3NpdGlvbjogUE9TSVRJT05TLlRPUF9FTkQsXG4gICAgICBwcm9ncmVzczogdHJ1ZSxcbiAgICAgIHNuYWNrYmFyOiBmYWxzZSxcbiAgICAgIHNvdW5kU291cmNlOiBcIlwiLFxuICAgICAgc291bmRhYmxlOiBmYWxzZSxcbiAgICAgIHN1YnRpdGxlOiB7XG4gICAgICAgIHJlbGF0aXZlOiB0cnVlLFxuICAgICAgICBkYXRldGltZTogRGF0ZS5ub3coKVxuICAgICAgfSxcbiAgICAgIHRleHQ6IFwiXCIsXG4gICAgICB0aXRsZTogXCJcIixcbiAgICAgIHR5cGU6IFRZUEVTLkRFRkFVTFQsXG4gICAgICAuLi5vcHRpb25zXG4gICAgfVxuXG4gICAgLy8gU2V0IHRoZSB0b2FzdCB0aW1lb3V0LlxuICAgIGlmICh0eXBlb2YgdGhpcy5vcHRpb25zLnN1YnRpdGxlICE9PSBcInN0cmluZ1wiKSB7XG4gICAgICBpZiAodHlwZW9mIHRoaXMub3B0aW9ucy5zdWJ0aXRsZSA9PT0gXCJvYmplY3RcIiAmJiBcImRhdGV0aW1lXCIgaW4gdGhpcy5vcHRpb25zLnN1YnRpdGxlKSB7XG4gICAgICAgIGNvbnN0IGRlbHRhOiBTdWJUaXRsZVR5cGUgPSB0aGlzLm9wdGlvbnMuc3VidGl0bGVcblxuICAgICAgICBpZiAoXCJyZWxhdGl2ZVwiIGluIHRoaXMub3B0aW9ucy5zdWJ0aXRsZSAmJiB0aGlzLm9wdGlvbnMuc3VidGl0bGUucmVsYXRpdmUpIHtcbiAgICAgICAgICB0aGlzLm9wdGlvbnMuc3VidGl0bGUgPSAobmV3IFJlbGF0aXZlRGF0ZShkZWx0YS5kYXRldGltZSkucHJpbnQoKSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm9wdGlvbnMuc3VidGl0bGUgPSBTdHJpbmcoZGVsdGEuZGF0ZXRpbWUpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBTZXQgdG9hc3QgZ3JvdXAuXG4gICAgLy8gVGhlIHRvYXN0IGdyb3VwIHVzZWQgdG8gb3JnYW5pemVkIHRoZSB0b2FzdHMuXG4gICAgdGhpcy5ncm91cCA9IHRoaXMub3B0aW9ucy5wb3NpdGlvbiEgfHwgUE9TSVRJT05TLlRPUF9FTkRcblxuXG4gICAgaWYgKE9iamVjdC5rZXlzKFBPU0lUSU9OUykuaW5jbHVkZXModGhpcy5vcHRpb25zLnBvc2l0aW9uISkpIHtcbiAgICAgIHRoaXMub3B0aW9ucy5wb3NpdGlvbiA9IHByZWZlcmVuY2VzLnBvc2l0aW9uc1t0aGlzLm9wdGlvbnMucG9zaXRpb24hXVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm9wdGlvbnMucG9zaXRpb24gPSBwcmVmZXJlbmNlcy5wb3NpdGlvbnMuVE9QX0VORFxuICAgIH1cblxuICAgIHRoaXMuaXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcbiAgICB0aGlzLnNwYWNlQmV0d2VlbiA9IDVcblxuICAgIGlmICh0aGlzLm9wdGlvbnMuc291bmRhYmxlICYmIHRoaXMub3B0aW9ucy5zb3VuZFNvdXJjZSAmJiB0aGlzLm9wdGlvbnMuc291bmRTb3VyY2UubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5zb3VuZCA9IG5ldyBTb3VuZCh0aGlzLm9wdGlvbnMuc291bmRTb3VyY2UsIHRoaXMucGFyZW50RWxlbWVudClcbiAgICB9XG5cbiAgICB0aGlzLmlkID0gVXRpbC5tYWtlSWQoKVxuICAgIHRoaXMuY3JlYXRlZEF0ID0gRGF0ZS5ub3coKS50b1N0cmluZygpXG4gICAgdGhpcy50aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgfSwgMClcbiAgICB0aGlzLnByb2dyZXNzSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgfSwgMClcbiAgICB0aGlzLnBhdXNlUHJvZ3Jlc3NJbnRlcnZhbCA9IGZhbHNlXG4gICAgdGhpcy5wcm9ncmVzc1N0YXJ0VGltZSA9IDBcblxuICB9XG5cbiAgLyoqXG4gICAqIFB1c2ggdGhlIHRvYXN0IHRvIHRoZSBkb2N1bWVudCBwYXJlbnQgbm9kZS5cbiAgICpcbiAgICogQHJldHVybiB7dGhpc30gVGhlIHRvYXN0IGluc3RhbmNlLlxuICAgKi9cbiAgcHVibGljIHNob3coKTogdGhpcyB7XG4gICAgY29uc3Qgcm9vdCA9IHRoaXMucGFyZW50RWxlbWVudFxuICAgIGNvbnN0IHRvYXN0ID0gdGhpcy5idWlsZFxuXG4gICAgcm9vdC5pbnNlcnRCZWZvcmUodG9hc3QsIHJvb3QuZmlyc3RDaGlsZClcblxuICAgIC8vIFBsYXkgc291bmQgaWYgaXQncyBhbGxvd2VkLlxuICAgIGlmICh0aGlzLnNvdW5kKSB7XG4gICAgICB0aGlzLnNvdW5kLmluc3RhbmNlLnBsYXkoKS5jYXRjaCgoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUud2FybihcIlNvdW5kIHNvdXJjZSBnaXZlbiBub3QgZm91bmQgb3Igbm90IHN1cHBvcnRlZC5cIilcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgLy8gT3JkZXIgdG9hc3RzLlxuICAgIHRoaXMub3JnYW5pemUoKVxuXG5cbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgLyoqXG4gICAqIEV2ZW50IHRvIGNsb3NlIHRvYXN0LiBVc2VkIGluIGhlYWRlciBjb21wb25lbnQuXG4gICAqXG4gICAqIEByZXR1cm4ge3ZvaWR9XG4gICAqL1xuICBwdWJsaWMgY2xvc2VFdmVudCA9ICgpOiB2b2lkID0+IHtcbiAgICB0aGlzLmRlc3Ryb3kodGhpcy5pdGVtKVxuICB9XG5cblxuICAvKipcbiAgICogQnVpbGQgdGhlIHRvYXN0IGVsZW1lbnQuXG4gICAqXG4gICAqIEByZXR1cm4ge0hUTUxFbGVtZW50fSBUaGUgZ2VuZXJhdGVkIHRvYXN0LlxuICAgKi9cbiAgcHJpdmF0ZSBnZXQgYnVpbGQoKTogSFRNTEVsZW1lbnQge1xuXG4gICAgLy8gQ29udGFpbmVyIEVsZW1lbnRcbiAgICBjb25zdCBjb250YWluZXIgPSBUb2FzdENvbnRhaW5lcih0aGlzKVxuXG4gICAgLy8gVG9hc3QgRWxlbWVudFxuICAgIGNvbnN0IHRvYXN0RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcbiAgICB0b2FzdEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRvYXN0XCIpXG5cbiAgICBjb250YWluZXIuc2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiLCB0aGlzLmlkKVxuICAgIGNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXCJkYXRhLWNyZWF0ZWQtYXRcIiwgdGhpcy5jcmVhdGVkQXQpXG4gICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZShcImRhdGEtdHlwZVwiLCB0aGlzLm9wdGlvbnMudHlwZSA/IHRoaXMub3B0aW9ucy50eXBlLnRvTG93ZXJDYXNlKCkgOiBcIlwiKVxuICAgIGNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXCJkYXRhLWdyb3VwXCIsIHRoaXMuZ3JvdXApXG4gICAgY29udGFpbmVyLnNldEF0dHJpYnV0ZShcImRhdGEtc25hY2tiYXJcIiwgU3RyaW5nKHRoaXMub3B0aW9ucy5zbmFja2JhcikpXG5cbiAgICAvLyBUb2FzdCBIZWFkZXIgKG9ubHkgaWYgb3B0aW9uIGhpZGVIZWFkZXIgaXMgc2V0IHRvIGZhbHNlKS5cbiAgICBpZiAoIUJvb2xlYW4odGhpcy5vcHRpb25zLnNuYWNrYmFyKSkge1xuICAgICAgdG9hc3RFbGVtZW50LmFwcGVuZENoaWxkKEhlYWRlckNvbXBvbmVudCh0aGlzKSlcbiAgICB9IGVsc2Uge1xuICAgICAgdG9hc3RFbGVtZW50LmNsYXNzTGlzdC5hZGQoLi4ucHJlZmVyZW5jZXMudHlwZXNbdGhpcy5vcHRpb25zLnR5cGVdKVxuICAgIH1cblxuICAgIC8vIFRvYXN0IEJvZHlcbiAgICB0b2FzdEVsZW1lbnQuYXBwZW5kQ2hpbGQoVG9hc3RCb2R5KHRoaXMpKVxuXG4gICAgaWYgKHRoaXMub3B0aW9ucy5wcm9ncmVzcykge1xuICAgICAgLy8gVG9hc3QgUHJvZ3Jlc3NcbiAgICAgIHRvYXN0RWxlbWVudC5hcHBlbmRDaGlsZChQcm9ncmVzc0NvbXBvbmVudCh0aGlzKSlcbiAgICB9XG5cblxuICAgIC8vIFB1dCB0b2FzdCBpbnRvIGl0J3MgY29udGFpbmVyLlxuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0b2FzdEVsZW1lbnQpXG5cbiAgICAvLyBXYXRjaCB0b2FzdCBoZWlnaHQgY2hhbmdlZCwgYW5kIHJlLW9yZGVyIGlmIGhhcHBlbi5cbiAgICBuZXcgUmVzaXplT2JzZXJ2ZXIoKCkgPT4ge1xuICAgICAgdGhpcy5vcmdhbml6ZSgpXG4gICAgfSkub2JzZXJ2ZShjb250YWluZXIpXG5cbiAgICAvLyBUb2FzdCBpbnN0YW5jZS5cbiAgICB0aGlzLml0ZW0gPSBjb250YWluZXJcblxuICAgIC8vIFNob3cgdGhlIHRvYXN0IGJ5IGFkZGluZyBjbGFzcyAoLnNob3cpXG4gICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJzaG93XCIpXG5cbiAgICBpZiAodGhpcy5vcHRpb25zLmR1cmF0aW9uID4gMCkge1xuICAgICAgdGhpcy50aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHRoaXMuZGVzdHJveShjb250YWluZXIpXG4gICAgICB9LCB0aGlzLm9wdGlvbnMuZHVyYXRpb24pXG5cbiAgICAgIGlmICh0aGlzLm9wdGlvbnMucGF1c2FibGUpIHtcbiAgICAgICAgY29uc3QgdG91Y2hTdGFydENhbGxCYWNrID0gKCkgPT4ge1xuICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXQpXG4gICAgICAgICAgdGhpcy5wYXVzZVByb2dyZXNzSW50ZXJ2YWwgPSB0cnVlXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB0b3VjaEVuZENhbGxCYWNrID0gKCkgPT4ge1xuICAgICAgICAgIHRoaXMucGF1c2VQcm9ncmVzc0ludGVydmFsID0gZmFsc2VcbiAgICAgICAgICB0aGlzLnByb2dyZXNzU3RhcnRUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKClcblxuICAgICAgICAgIHRoaXMudGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5kZXN0cm95KHRoaXMuaXRlbSlcbiAgICAgICAgICB9LCB0aGlzLm9wdGlvbnMuZHVyYXRpb24pXG4gICAgICAgIH1cblxuICAgICAgICBcIm1vdXNlb3ZlciB0b3VjaHN0YXJ0IHRvdWNoZW5kXCIuc3BsaXQoXCIgXCIpLmZvckVhY2goZSA9PiB7XG4gICAgICAgICAgdGhpcy5pdGVtLmFkZEV2ZW50TGlzdGVuZXIoZSwgdG91Y2hTdGFydENhbGxCYWNrKVxuICAgICAgICB9KVxuXG4gICAgICAgIFwibW91c2VsZWF2ZSB0b3VjaGVuZFwiLnNwbGl0KFwiIFwiKS5mb3JFYWNoKGUgPT4ge1xuICAgICAgICAgIHRoaXMuaXRlbS5hZGRFdmVudExpc3RlbmVyKGUsIHRvdWNoRW5kQ2FsbEJhY2spXG4gICAgICAgIH0pXG4gICAgICB9XG5cbiAgICB9XG4gICAgLy8gUmV0dXJuIHRvYXN0IGluc3RhbmNlLlxuICAgIHJldHVybiBjb250YWluZXJcbiAgfVxuXG4gIC8qKlxuICAgKiAgVGhlIHBhcmVudCBlbGVtZW50LCB3aGljaCB3aWxsIGNvbnRhaW4gdGhlIHRvYXN0cy5cbiAgICogQHJldHVybiB7RWxlbWVudH0gIFRoZSBtYWluIGVsZW1lbnQgc2VsZWN0ZWQgYnkgdGhlIHVzZXIgaWYgYXZhaWxhYmxlLCBvciB0aGUgZGVmYXVsdCBwYXJlbnQuXG4gICAqL1xuICBwcml2YXRlIGdldCBwYXJlbnRFbGVtZW50KCk6IEVsZW1lbnQge1xuICAgIGlmICh0aGlzLm9wdGlvbnMucGFyZW50KSB7XG4gICAgICBjb25zdCB1c2VyUm9vdEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMub3B0aW9ucy5wYXJlbnQpXG4gICAgICBpZiAoIXVzZXJSb290RWxlbWVudCkge1xuICAgICAgICB0aHJvdyBcIlVzZXIgcm9vdCBlbGVtZW50IG5vdCBleGlzdHMuXCJcbiAgICAgIH1cblxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkodXNlclJvb3RFbGVtZW50KSkge1xuICAgICAgICByZXR1cm4gdXNlclJvb3RFbGVtZW50WzBdXG4gICAgICB9XG5cbiAgICAgIHJldHVybiB1c2VyUm9vdEVsZW1lbnRcbiAgICB9XG5cbiAgICByZXR1cm4gZG9jdW1lbnQuYm9keVxuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSB0aGUgZWxlbWVudCBmcm9tIGRvbSBhZnRlciB0aW1lb3V0IGZpbmlzaGVkLlxuICAgKi9cbiAgcHJpdmF0ZSBkZXN0cm95KHRvYXN0RWxlbWVudDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICAvLyBIaWRlIHRoZSBlbGVtZW50LlxuICAgIHRvYXN0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwic2hvd1wiKVxuXG4gICAgaWYgKHR5cGVvZiB0aGlzLm9wdGlvbnMub25DbG9zZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICB0aGlzLm9wdGlvbnMub25DbG9zZSh0aGlzKVxuICAgIH1cblxuICAgIHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHRvYXN0RWxlbWVudC5wYXJlbnROb2RlPy5yZW1vdmVDaGlsZCh0b2FzdEVsZW1lbnQpXG4gICAgfSwgNDAwKVxuXG5cbiAgfVxuXG4gIHByaXZhdGUgb3JnYW5pemUoKSB7XG4gICAgY29uc3QgeyBvZmZzZXQgfSA9IHRoaXMub3B0aW9uc1xuXG4gICAgY29uc3QgdG9wTGVmdE9mZnNldFNpemUgPSB7XG4gICAgICB0b3A6IE51bWJlcihvZmZzZXQpLFxuICAgICAgYm90dG9tOiBOdW1iZXIob2Zmc2V0KSxcbiAgICB9XG5cblxuICAgIGNvbnN0IHRvcFJpZ2h0T2Zmc2V0U2l6ZSA9IHtcbiAgICAgIHRvcDogTnVtYmVyKG9mZnNldCksXG4gICAgICBib3R0b206IE51bWJlcihvZmZzZXQpLFxuICAgIH1cblxuICAgIGNvbnN0IG9mZnNldFNpemUgPSB7XG4gICAgICB0b3A6IE51bWJlcihvZmZzZXQpLFxuICAgICAgYm90dG9tOiBOdW1iZXIob2Zmc2V0KSxcbiAgICB9XG5cblxuICAgIGxldCBzZWxlY3RvciA9IGAuJHtnY2xhc3MoXCJjb250YWluZXJcIil9W2RhdGEtZ3JvdXA9JyR7dGhpcy5ncm91cH0nXWBcblxuICAgIGNvbnN0IHdpbmRvd1dpZHRoID0gd2luZG93LmlubmVyV2lkdGggPiAwID8gd2luZG93LmlubmVyV2lkdGggOiBzY3JlZW4ud2lkdGhcblxuICAgIGlmICh3aW5kb3dXaWR0aCA8PSAzNjApIHtcbiAgICAgIHNlbGVjdG9yID0gYC4ke2djbGFzcyhcImNvbnRhaW5lclwiKX1gXG4gICAgfVxuICAgIGNvbnN0IHRvYXN0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGw8SFRNTERpdkVsZW1lbnQ+KHNlbGVjdG9yKVxuXG4gICAgbGV0IGNsYXNzVXNlZFxuXG4gICAgaWYgKHRvYXN0cy5sZW5ndGggPiAwKSB7XG4gICAgICB0b2FzdHMuZm9yRWFjaCgodG9hc3QpID0+IHtcblxuICAgICAgICBpZiAoaGFzQ2xhc3ModG9hc3QsIGdjbGFzcyhcInRvcFwiKSkpIHtcbiAgICAgICAgICBjbGFzc1VzZWQgPSBnY2xhc3MoXCJ0b3BcIilcbiAgICAgICAgfSBlbHNlIGlmIChoYXNDbGFzcyh0b2FzdCwgZ2NsYXNzKFwibWlkZGxlXCIpKSkge1xuICAgICAgICAgIGNsYXNzVXNlZCA9IGdjbGFzcyhcIm1pZGRsZVwiKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNsYXNzVXNlZCA9IGdjbGFzcyhcImJvdHRvbVwiKVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdG9hc3RIZWlnaHQgPSB0b2FzdC5vZmZzZXRIZWlnaHRcbiAgICAgICAgY2xhc3NVc2VkID0gY2xhc3NVc2VkLnN1YnN0cihcbiAgICAgICAgICBgJHtjcHJlZml4fS1gLmxlbmd0aCAtIDEsXG4gICAgICAgICAgY2xhc3NVc2VkLmxlbmd0aCAtIDEsXG4gICAgICAgIClcblxuICAgICAgICAvLyBTaG93IHRvYXN0IGluIGNlbnRlciBpZiBzY3JlZW4gd2l0aCBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gMzYwcHguXG4gICAgICAgIGlmICh3aW5kb3dXaWR0aCA8PSAzNjApIHtcbiAgICAgICAgICB0b2FzdC5zdHlsZVtjbGFzc1VzZWRdID0gb2Zmc2V0U2l6ZVtjbGFzc1VzZWRdICsgXCJweFwiXG4gICAgICAgICAgb2Zmc2V0U2l6ZVtjbGFzc1VzZWRdICs9IHRvYXN0SGVpZ2h0ICsgdGhpcy5zcGFjZUJldHdlZW5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoaGFzQ2xhc3ModG9hc3QsIGBzdGFydC0ke3RoaXMub3B0aW9ucy5vZmZzZXR9YCkpIHtcbiAgICAgICAgICAgIHRvYXN0LnN0eWxlW2NsYXNzVXNlZF0gPSB0b3BMZWZ0T2Zmc2V0U2l6ZVtjbGFzc1VzZWRdICsgXCJweFwiXG4gICAgICAgICAgICB0b3BMZWZ0T2Zmc2V0U2l6ZVtjbGFzc1VzZWRdICs9IHRvYXN0SGVpZ2h0ICsgdGhpcy5zcGFjZUJldHdlZW5cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdG9hc3Quc3R5bGVbY2xhc3NVc2VkXSA9IHRvcFJpZ2h0T2Zmc2V0U2l6ZVtjbGFzc1VzZWRdICsgXCJweFwiXG4gICAgICAgICAgICB0b3BSaWdodE9mZnNldFNpemVbY2xhc3NVc2VkXSArPSB0b2FzdEhlaWdodCArIHRoaXMuc3BhY2VCZXR3ZWVuXG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgIH0pXG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFRvYXN0c3RyYXBcbiIsImltcG9ydCB7IGdjbGFzcyB9IGZyb20gXCIuLi9wcmVmZXJlbmNlc1wiXG5pbXBvcnQgVG9hc3RzdHJhcCBmcm9tIFwiLi4vVG9hc3RzdHJhcFwiXG5cbmV4cG9ydCBjb25zdCBUb2FzdENvbnRhaW5lciA9IChjb250ZXh0OiBUb2FzdHN0cmFwKSA9PiB7XG4gIGNvbnN0IHsgb3B0aW9ucyB9ID0gY29udGV4dFxuICBjb25zdCBjb250YWluZXJFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKVxuICBjb250YWluZXJFbGVtZW50LmNsYXNzTmFtZSA9IGAke1xuICAgIGNvbnRleHQub3B0aW9ucy5wYXJlbnQgPyBcInBvc2l0aW9uLWFic29sdXRlXCIgOiBcInBvc2l0aW9uLWZpeGVkXCJcbiAgfSAke29wdGlvbnMucG9zaXRpb259LSR7b3B0aW9ucy5vZmZzZXR9ICR7Z2NsYXNzKFwiY29udGFpbmVyXCIpfWBcblxuICBjb250YWluZXJFbGVtZW50LnN0eWxlLnpJbmRleCA9IFwiMjUwMFwiXG5cbiAgcmV0dXJuIGNvbnRhaW5lckVsZW1lbnRcbn1cbiIsImltcG9ydCBUb2FzdHN0cmFwIGZyb20gXCIuLi9Ub2FzdHN0cmFwXCJcbmltcG9ydCBwcmVmZXJlbmNlcyBmcm9tIFwiLi4vcHJlZmVyZW5jZXNcIlxuaW1wb3J0IHR5cGUgeyBPcHRpb25zVHlwZSB9IGZyb20gXCIuLi90eXBlc1wiXG5cbmNvbnN0IEF2YXRhckNvbXBvbmVudCA9IChvcHRpb25zOiBPcHRpb25zVHlwZSkgPT4ge1xuICBjb25zdCBhdmF0YXJFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImltZ1wiKVxuICBhdmF0YXJFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJyb3VuZGVkXCIsIFwibWUtMlwiKVxuICBhdmF0YXJFbGVtZW50LnNyYyA9IG9wdGlvbnMuYXZhdGFyIHx8IFwiXCJcbiAgYXZhdGFyRWxlbWVudC53aWR0aCA9IDIwXG4gIGF2YXRhckVsZW1lbnQuaGVpZ2h0ID0gMjBcblxuICByZXR1cm4gYXZhdGFyRWxlbWVudFxufVxuXG5jb25zdCBDbG9zZUJ1dHRvbkNvbXBvbmVudCA9IChvbkNsb3NlRXZlbnQ6ICgpID0+IHZvaWQpID0+IHtcbiAgY29uc3QgY2xvc2VCdG5FbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKVxuICBjbG9zZUJ0bkVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImJ0bi1jbG9zZVwiKVxuICBjbG9zZUJ0bkVsZW1lbnQuc2V0QXR0cmlidXRlKFwidHlwZVwiLCBcImJ1dHRvblwiKVxuICBjbG9zZUJ0bkVsZW1lbnQuc2V0QXR0cmlidXRlKFwiYXJlYS1sYWJlbFwiLCBcIkNsb3NlXCIpXG5cbiAgY2xvc2VCdG5FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgZXZ0LnN0b3BQcm9wYWdhdGlvbigpXG4gICAgb25DbG9zZUV2ZW50KClcbiAgfSlcblxuICByZXR1cm4gY2xvc2VCdG5FbGVtZW50XG59XG5cbmV4cG9ydCBjb25zdCBIZWFkZXJDb21wb25lbnQgPSAoY29udGV4dDogVG9hc3RzdHJhcCk6IEVsZW1lbnQgPT4ge1xuICBjb25zdCB7IG9wdGlvbnMgfSA9IGNvbnRleHRcbiAgY29uc3QgaGVhZGVyRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcbiAgaGVhZGVyRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidG9hc3QtaGVhZGVyXCIpXG5cbiAgLy8gQXZhdGFyIGVsZW1lbnRcbiAgaWYgKG9wdGlvbnMuYXZhdGFyKSB7XG4gICAgaGVhZGVyRWxlbWVudC5hcHBlbmRDaGlsZChBdmF0YXJDb21wb25lbnQob3B0aW9ucykpXG4gIH1cblxuICBpZiAob3B0aW9ucy50eXBlKSB7XG4gICAgaGVhZGVyRWxlbWVudC5jbGFzc0xpc3QuYWRkKC4uLnByZWZlcmVuY2VzLnR5cGVzW29wdGlvbnMudHlwZV0pXG4gIH1cblxuXG4gIC8vIENyZWF0ZSB0aXRsZSBlbGVtZW50LlxuICBjb25zdCB0aXRsZUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3Ryb25nXCIpXG4gIHRpdGxlRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibWUtYXV0b1wiKVxuICB0aXRsZUVsZW1lbnQuaW5uZXJUZXh0ID0gb3B0aW9ucy50aXRsZVxuICBoZWFkZXJFbGVtZW50LmFwcGVuZENoaWxkKHRpdGxlRWxlbWVudClcblxuICBpZiAob3B0aW9ucy5zdWJ0aXRsZSkge1xuICAgIC8vIHRpbWVcbiAgICBjb25zdCB0aW1lRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzbWFsbFwiKVxuICAgIGlmICh0eXBlb2Ygb3B0aW9ucy5zdWJ0aXRsZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgdGltZUVsZW1lbnQuaW5uZXJUZXh0ID0gb3B0aW9ucy5zdWJ0aXRsZVxuICAgIH1cblxuICAgIGhlYWRlckVsZW1lbnQuYXBwZW5kQ2hpbGQodGltZUVsZW1lbnQpXG4gIH1cblxuICAvLyBDbG9zZSBidXR0b25cbiAgaWYgKG9wdGlvbnMuZGlzbWlzc2libGUpIHtcbiAgICBoZWFkZXJFbGVtZW50LmFwcGVuZENoaWxkKENsb3NlQnV0dG9uQ29tcG9uZW50KGNvbnRleHQuY2xvc2VFdmVudCkpXG4gIH1cblxuICAvLyBSZXR1cm4gaGVhZGVyIGVsZW1lbnQuXG4gIHJldHVybiBoZWFkZXJFbGVtZW50XG59XG4iLCJpbXBvcnQgVG9hc3RzdHJhcCBmcm9tIFwiLi4vVG9hc3RzdHJhcFwiXG5cbmV4cG9ydCBjb25zdCBUb2FzdEJvZHkgPSAoY29udGV4dDogVG9hc3RzdHJhcCkgPT4ge1xuICBjb25zdCB7IG9wdGlvbnMgfSA9IGNvbnRleHRcbiAgY29uc3QgYm9keUVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpXG4gIGJvZHlFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJ0b2FzdC1ib2R5XCIpXG4gIGJvZHlFbGVtZW50LmlubmVySFRNTCA9IG9wdGlvbnMudGV4dFxuXG4gIHJldHVybiBib2R5RWxlbWVudFxufVxuIiwiLyoqXG4gKiBAY3JlZGl0IGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8zMTUzMDk0NlxuICogQHBhcmFtIGR1cmF0aW9uXG4gKiBAY29uc3RydWN0b3JcbiAqL1xuaW1wb3J0IFRvYXN0c3RyYXAgZnJvbSBcIi4uL1RvYXN0c3RyYXBcIlxuXG5leHBvcnQgY29uc3QgUHJvZ3Jlc3NDb21wb25lbnQgPSAoZmFjdG9yeTogVG9hc3RzdHJhcCkgPT4ge1xuICBsZXQgeyBkdXJhdGlvbiB9ID0gZmFjdG9yeS5vcHRpb25zXG5cblxuICBjb25zdCBwcm9ncmVzc0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpXG4gIHByb2dyZXNzRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwidG9hc3QtZm9vdGVyXCIpXG4gIGNvbnN0IGluZGljYXRvckVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpXG4gIGluZGljYXRvckVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInRvYXN0LWZvb3Rlci1pbm5lclwiKVxuICBwcm9ncmVzc0VsZW1lbnQuYXBwZW5kQ2hpbGQoaW5kaWNhdG9yRWxlbWVudClcblxuXG4gIGlmIChkdXJhdGlvbiA+IDApIHtcbiAgICBkdXJhdGlvbiA8IDEwMCAgPyBkdXJhdGlvbiA9IGR1cmF0aW9uICogMTAwMCA6IGR1cmF0aW9uO1xuXG4gICAgaW5kaWNhdG9yRWxlbWVudC5zdHlsZS5hbmltYXRpb25EdXJhdGlvbiA9IGAke2R1cmF0aW9ufW1zYFxuXG4gIH1cbiAgLyoqXG4gICAqIEkgbWFkZSB0aGlzIHRvIG1ha2UgcHJvZ3Jlc3MgbW92ZSB3aGVuIGR1cmF0aW9uIGlzIHNldC5cbiAgICogQnV0IGl0J3Mga2lsbCB0aGUgcGVyZm9ybWFuY2UsIHNvIEkgZGVjaWRlZCB0byB1c2UgQ1NTIHRvIGRvIHRoYXQuXG4gICAqXG4gICAqIEBkZXByZWNhdGVkXG4gICAqL1xuICAvLyBAdHMtaWdub3JlXG4gIGNvbnN0IHN0YXJ0ID0gKCkgPT4ge1xuICAgIGZhY3RvcnkucHJvZ3Jlc3NTdGFydFRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKVxuXG4gICAgLy8gPi4uPCBJIHdpbGwganVzdCB1c2UgY3NzIHRvIGRvIHRoYXQuXG4gICAgaWYgKGR1cmF0aW9uID4gMCkge1xuICAgICAgZmFjdG9yeS5wcm9ncmVzc0ludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICBpZiAoIWZhY3RvcnkucGF1c2VQcm9ncmVzc0ludGVydmFsKSB7XG4gICAgICAgICAgY29uc3QgZGlmZiA9IE1hdGgucm91bmQobmV3IERhdGUoKS5nZXRUaW1lKCkgLSBmYWN0b3J5LnByb2dyZXNzU3RhcnRUaW1lKVxuICAgICAgICAgIGxldCB2YWx1ZSA9IE1hdGgucm91bmQoZGlmZiAvIGR1cmF0aW9uICogMTAwKVxuICAgICAgICAgIHZhbHVlID0gdmFsdWUgPiAxMDAgPyAxMDAgOiB2YWx1ZVxuXG4gICAgICAgICAgaW5kaWNhdG9yRWxlbWVudC5zdHlsZS53aWR0aCA9IHZhbHVlICsgXCIlXCJcblxuICAgICAgICAgIGlmIChkaWZmID49IGR1cmF0aW9uKSB7XG4gICAgICAgICAgICBjbGVhckludGVydmFsKGZhY3RvcnkucHJvZ3Jlc3NJbnRlcnZhbClcbiAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgICAgfSwgMTAwKVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBwcm9ncmVzc0VsZW1lbnRcbn1cbiIsIi8qKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIENoZWNraW5nIGFuZCBzZWN1cmluZyBvcHRpb25zIHR5cGVzLlxuICogT25seSBmb3IgYnJvd3NlcnMuXG4gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5pbXBvcnQgeyBPcHRpb25zVHlwZSB9IGZyb20gXCIuL3R5cGVzXCJcbmltcG9ydCBVdGlsIGZyb20gXCIuL1V0aWxcIlxuXG5jb25zdCBUWVBFX0NIRUNLID0gXCJUeXBlRXJyb3I6IE9wdGlvbiB7b3B0aW9ufSBzaG91bGQgYmUgaW4gdHlwZSB7dHlwZX0uXCJcblxuY29uc3QgcmVzb2x2ZSA9IChwYXRoOiBzdHJpbmcsIG9iaiA9IHNlbGYsIHNlcGFyYXRvciA9IFwiLlwiKSA9PiB7XG4gIGNvbnN0IHByb3BlcnRpZXMgPSBBcnJheS5pc0FycmF5KHBhdGgpID8gcGF0aCA6IHBhdGguc3BsaXQoc2VwYXJhdG9yKVxuICAvLyBAdHMtaWdub3JlXG4gIHJldHVybiBwcm9wZXJ0aWVzLnJlZHVjZSgocHJldiwgY3VycikgPT4gcHJldiAmJiBwcmV2W2N1cnJdLCBvYmopXG59XG5cbmNvbnN0IGNoZWNrcyA9IFtcbiAgW1RZUEVfQ0hFQ0ssIFwiZGlzbWlzc2libGVcIiwgXCJib29sZWFuXCJdLFxuICBbVFlQRV9DSEVDSywgXCJkdXJhdGlvblwiLCBcIm51bWJlclwiXSxcbiAgW1RZUEVfQ0hFQ0ssIFwib2Zmc2V0XCIsIFwibnVtYmVyXCJdLFxuICBbVFlQRV9DSEVDSywgXCJvbkNsb3NlXCIsIFwiZnVuY3Rpb25cIl0sXG4gIFtUWVBFX0NIRUNLLCBcIm9uU2hvd1wiLCBcImZ1bmN0aW9uXCJdLFxuICBbVFlQRV9DSEVDSywgXCJwYXJlbnRcIiwgXCJzdHJpbmdcIl0sXG4gIFtUWVBFX0NIRUNLLCBcInBhdXNhYmxlXCIsIFwiYm9vbGVhblwiXSxcbiAgW1RZUEVfQ0hFQ0ssIFwicG9zaXRpb25cIiwgXCJzdHJpbmdcIl0sXG4gIFtUWVBFX0NIRUNLLCBcInByb2dyZXNzXCIsIFwiYm9vbGVhblwiXSxcbiAgW1RZUEVfQ0hFQ0ssIFwic25hY2tiYXJcIiwgXCJib29sZWFuXCJdLFxuICBbVFlQRV9DSEVDSywgXCJzb3VuZFNvdXJjZVwiLCBcInN0cmluZ1wiXSxcbiAgW1RZUEVfQ0hFQ0ssIFwic291bmRhYmxlXCIsIFwiYm9vbGVhblwiXSxcbiAgW1RZUEVfQ0hFQ0ssIFwic3VidGl0bGVcIiwgW1wic3RyaW5nXCIsIFwib2JqZWN0XCJdXSxcbiAgW1RZUEVfQ0hFQ0ssIFwidGV4dFwiLCBcInN0cmluZ1wiXSxcbiAgW1RZUEVfQ0hFQ0ssIFwidGl0bGVcIiwgXCJzdHJpbmdcIl0sXG4gIFtUWVBFX0NIRUNLLCBcInR5cGVcIiwgXCJzdHJpbmdcIl0sXG4gIFtUWVBFX0NIRUNLLCBcInN1YnRpdGxlLnJlbGF0aXZlXCIsIFwiYm9vbGVhblwiXSxcbiAgW1RZUEVfQ0hFQ0ssIFwic3VidGl0bGUuZGF0ZXRpbWVcIiwgW1wic3RyaW5nXCIsIFwiRGF0ZVwiLCBcIm51bWJlclwiXV0sXG5dXG5cbmNvbnN0IGZpbHRlcnMgPSAob3B0aW9uczogT3B0aW9uc1R5cGUpID0+IHtcbiAgaWYgKGNoZWNrcy5sZW5ndGggPiAwKSB7XG4gICAgY2hlY2tzLmZvckVhY2goY2hlY2sgPT4ge1xuICAgICAgY29uc3QgZmlyc3RJbmRleCA9IGNoZWNrWzBdXG4gICAgICBjb25zdCBzZWNvbmRJbmRleCA9IGNoZWNrWzFdXG4gICAgICBjb25zdCBsYXN0SW5kZXggPSBjaGVja1syXVxuXG4gICAgICBpZiAoQXJyYXkuaXNBcnJheShsYXN0SW5kZXgpKSB7XG4gICAgICAgIGxldCBzdWNjZWVkID0gZmFsc2VcblxuICAgICAgICBsYXN0SW5kZXguZm9yRWFjaCh0eXBlID0+IHtcblxuICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICBpZiAodHlwZW9mIHJlc29sdmUoc2Vjb25kSW5kZXgsIG9wdGlvbnMpICE9PSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiByZXNvbHZlKHNlY29uZEluZGV4LCBvcHRpb25zKSA9PT0gdHlwZSkge1xuICAgICAgICAgICAgc3VjY2VlZCA9IHRydWVcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuICAgICAgICBpZiAoIXN1Y2NlZWQpIHtcbiAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgdGhyb3cgVXRpbC5zdHJGb3JtYXQoZmlyc3RJbmRleCwgeyBvcHRpb246IHNlY29uZEluZGV4LCB0eXBlOiBsYXN0SW5kZXgudG9TdHJpbmcoKSB9KVxuICAgICAgICB9XG5cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgaWYgKHJlc29sdmUoc2Vjb25kSW5kZXgsIG9wdGlvbnMpICYmIHR5cGVvZiByZXNvbHZlKHNlY29uZEluZGV4LCBvcHRpb25zKSAhPT0gbGFzdEluZGV4KSB7XG4gICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgIHRocm93IFV0aWwuc3RyRm9ybWF0KGZpcnN0SW5kZXgsIHsgb3B0aW9uOiBzZWNvbmRJbmRleCwgdHlwZTogbGFzdEluZGV4IH0pXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZpbHRlcnMiLCJpbXBvcnQgVG9hc3RzdHJhcCBmcm9tIFwiLi9Ub2FzdHN0cmFwXCJcbmltcG9ydCB0eXBlIHsgT3B0aW9uc1R5cGUgfSBmcm9tIFwiLi90eXBlc1wiXG5pbXBvcnQgeyBQT1NJVElPTlMsIFRZUEVTIH0gZnJvbSBcIi4vcHJlZmVyZW5jZXNcIlxuaW1wb3J0IFwiLi9hc3NldHMvc3R5bGVzLnNjc3NcIlxuaW1wb3J0IGZpbHRlcnMgZnJvbSBcIi4vdHlwZWNoZWNrXCJcblxuZGVjbGFyZSBnbG9iYWwge1xuICBpbnRlcmZhY2UgV2luZG93IHtcbiAgICB0b2FzdHN0cmFwOiAob3B0aW9uczogT3B0aW9uc1R5cGUpID0+IFRvYXN0c3RyYXA7XG4gICAgdG9hc3RzdHJhcF9wb3NpdGlvbjogYW55LFxuICAgIHRvYXN0c3RyYXBfdHlwZTogYW55XG4gIH1cbn1cblxuLyoqXG4gKlxuICogQHBhcmFtIHtPcHRpb25zVHlwZX0gb3B0aW9uc1xuICovXG5jb25zdCBpbml0aWFsaXplID0gKG9wdGlvbnM6IE9wdGlvbnNUeXBlKTogVG9hc3RzdHJhcCA9PiB7XG5cbiAgLy8gVHlwZSBjaGVja3MuXG4gIGlmIChPYmplY3Qua2V5cyhvcHRpb25zKS5sZW5ndGgpIHtcbiAgICBmaWx0ZXJzKG9wdGlvbnMpO1xuICB9XG4gIHJldHVybiBuZXcgVG9hc3RzdHJhcCh7XG4gICAgLi4ub3B0aW9ucyxcbiAgfSlcbn1cblxuLy8gV2luZG93XG53aW5kb3cudG9hc3RzdHJhcCA9IGluaXRpYWxpemVcbndpbmRvdy50b2FzdHN0cmFwX3Bvc2l0aW9uID0gUE9TSVRJT05TXG53aW5kb3cudG9hc3RzdHJhcF90eXBlID0gVFlQRVMiXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsImV4cG9ydHMiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwidmFsdWUiLCJQT1NJVElPTlMiLCJUWVBFUyIsImNwcmVmaXgiLCJnY2xhc3MiLCJjIiwicG9zaXRpb25zIiwiVE9QX1NUQVJUIiwiVE9QX0VORCIsIlRPUF9DRU5URVIiLCJCT1RUT01fQ0VOVEVSIiwiQk9UVE9NX1NUQVJUIiwiQk9UVE9NX0VORCIsInR5cGVzIiwiREVGQVVMVCIsIlBSSU1BUlkiLCJJTkZPIiwiU1VDQ0VTUyIsIldBUk5JTkciLCJEQU5HRVIiLCJEQVJLIiwiU0VDT05EQVJZIiwiU1dFRVQiLCJoYXNDbGFzcyIsImVsZW1lbnQiLCJjbGFzc05hbWUiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsImF1ZGlvRmlsZSIsInBhcmVudEVsZW1lbnQiLCJ0aGlzIiwic2VsZWN0b3IiLCJBdWRpbyIsInBhcmVudCIsIm1ha2UiLCJpZCIsInF1ZXJ5U2VsZWN0b3IiLCJhcHBlbmRDaGlsZCIsImlucHV0IiwicmVmZXJlbmNlIiwidGltZXMiLCJTRUNPTkQiLCJNSU5VVEUiLCJIT1VSIiwiREFZIiwiV0VFSyIsIllFQVIiLCJNT05USCIsImZvcm1hdHMiLCJOdW1iZXIiLCJNQVhfVkFMVUUiLCJEYXRlIiwiZ2V0VGltZSIsInByaW50IiwiZm9ybWF0IiwiaW5kZXgiLCJsZW5ndGgiLCJkZWx0YSIsInVuZGVmaW5lZCIsIk1hdGgiLCJyb3VuZCIsInN0ckZvcm1hdCIsInN0ciIsInZhbHVlcyIsImtleXMiLCJyZWdleCIsIlJlZ0V4cCIsInJlcGxhY2UiLCJrZXkiLCJtYWtlSWQiLCJTdHJpbmciLCJmbG9vciIsInJhbmRvbSIsIm9wdGlvbnMiLCJjbG9zZUV2ZW50IiwiZGVzdHJveSIsIml0ZW0iLCJhdmF0YXIiLCJkaXNtaXNzaWJsZSIsImR1cmF0aW9uIiwib2Zmc2V0IiwicGF1c2FibGUiLCJwb3NpdGlvbiIsInByb2dyZXNzIiwic25hY2tiYXIiLCJzb3VuZFNvdXJjZSIsInNvdW5kYWJsZSIsInN1YnRpdGxlIiwicmVsYXRpdmUiLCJkYXRldGltZSIsIm5vdyIsInRleHQiLCJ0aXRsZSIsInR5cGUiLCJncm91cCIsImluY2x1ZGVzIiwicHJlZmVyZW5jZXMiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJzcGFjZUJldHdlZW4iLCJzb3VuZCIsImNyZWF0ZWRBdCIsInRvU3RyaW5nIiwidGltZW91dCIsInNldFRpbWVvdXQiLCJwcm9ncmVzc0ludGVydmFsIiwic2V0SW50ZXJ2YWwiLCJwYXVzZVByb2dyZXNzSW50ZXJ2YWwiLCJwcm9ncmVzc1N0YXJ0VGltZSIsInNob3ciLCJyb290IiwidG9hc3QiLCJidWlsZCIsImluc2VydEJlZm9yZSIsImZpcnN0Q2hpbGQiLCJpbnN0YW5jZSIsInBsYXkiLCJjYXRjaCIsImNvbnNvbGUiLCJ3YXJuIiwib3JnYW5pemUiLCJjb250YWluZXJFbGVtZW50IiwiY29udGFpbmVyIiwic3R5bGUiLCJ6SW5kZXgiLCJ0b2FzdEVsZW1lbnQiLCJhZGQiLCJzZXRBdHRyaWJ1dGUiLCJ0b0xvd2VyQ2FzZSIsIkJvb2xlYW4iLCJjb250ZXh0IiwiaGVhZGVyRWxlbWVudCIsImF2YXRhckVsZW1lbnQiLCJzcmMiLCJ3aWR0aCIsImhlaWdodCIsIkF2YXRhckNvbXBvbmVudCIsIm9uQ2xvc2VFdmVudCIsImNsb3NlQnRuRWxlbWVudCIsInRpdGxlRWxlbWVudCIsImlubmVyVGV4dCIsInRpbWVFbGVtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2dCIsInN0b3BQcm9wYWdhdGlvbiIsIkhlYWRlckNvbXBvbmVudCIsImJvZHlFbGVtZW50IiwiaW5uZXJIVE1MIiwiVG9hc3RCb2R5IiwiZmFjdG9yeSIsInByb2dyZXNzRWxlbWVudCIsImluZGljYXRvckVsZW1lbnQiLCJhbmltYXRpb25EdXJhdGlvbiIsIlByb2dyZXNzQ29tcG9uZW50IiwiUmVzaXplT2JzZXJ2ZXIiLCJvYnNlcnZlIiwiY2xlYXJUaW1lb3V0Iiwic3BsaXQiLCJmb3JFYWNoIiwiZSIsInVzZXJSb290RWxlbWVudCIsIkFycmF5IiwiaXNBcnJheSIsImJvZHkiLCJyZW1vdmUiLCJvbkNsb3NlIiwid2luZG93IiwicGFyZW50Tm9kZSIsInJlbW92ZUNoaWxkIiwidG9wTGVmdE9mZnNldFNpemUiLCJ0b3AiLCJib3R0b20iLCJ0b3BSaWdodE9mZnNldFNpemUiLCJvZmZzZXRTaXplIiwid2luZG93V2lkdGgiLCJpbm5lcldpZHRoIiwic2NyZWVuIiwiY2xhc3NVc2VkIiwidG9hc3RzIiwicXVlcnlTZWxlY3RvckFsbCIsInRvYXN0SGVpZ2h0Iiwib2Zmc2V0SGVpZ2h0Iiwic3Vic3RyIiwiVFlQRV9DSEVDSyIsInJlc29sdmUiLCJwYXRoIiwib2JqIiwic2VwYXJhdG9yIiwicmVkdWNlIiwicHJldiIsImN1cnIiLCJjaGVja3MiLCJ0b2FzdHN0cmFwIiwiY2hlY2siLCJmaXJzdEluZGV4Iiwic2Vjb25kSW5kZXgiLCJsYXN0SW5kZXgiLCJvcHRpb24iLCJ0b2FzdHN0cmFwX3Bvc2l0aW9uIiwidG9hc3RzdHJhcF90eXBlIl0sInNvdXJjZVJvb3QiOiIifQ==